YOKUL={};YOKUL.charts={};YOKUL.useContext=function YOKUL_useContext(a,b){a.save();b(a);a.restore();};YOKUL.utility={getQueryDataFromElement:function utility_getQueryDataFromElement(a){return a.getAttribute("data-src")||a.getAttribute("data-chart-src");},min:function utility_min(c){var b=Number.MAX_VALUE,a;if(!c||!c.length){return undefined;}for(a=0;a<c.length;++a){if(c[a]<b){b=c[a];}}return b;},max:function utility_max(c){var a=Number.MIN_VALUE,b;if(!c||!c.length){return undefined;}for(b=0;b<c.length;++b){if(c[b]>a){a=c[b];}}return a;},min2d:function utility_min2d(c){var d=this.min(c[0]);for(var b=1;b<c.length;++b){var a=this.min(c[b]);if(a<d){d=a;}}return d;},max2d:function utility_max2d(d){var c=this.max(d[0]);for(var b=1;b<d.length;++b){var a=this.max(d[b]);if(a>c){c=a;}}return c;}};YOKUL.log=(function(){function a(e,c){if(YOKUL.logOutput&&YOKUL.logOutput[e]){var b=YOKUL.debugOutput&&document.getElementById(YOKUL.debugOutput);if(!b){console.log(e+c);}else{var d=document.createElement("div");d.className="debug-msg";d.innerHTML="<span class='debug-header "+e+"'>"+e+"</span>"+c+"</span>";b.appendChild(d);}}}return{info:function(b){a("info",b);},error:function(b){a("error",b);},warning:function(b){a("warning",b);}};})();YOKUL.defaults={titleHeight:24,titleFont:"14px sans-serif",titleColor:"#444444",axisLabelHeight:16,axisLabelFont:"11px sans-serif",axisLabelColor:"gray",seriesColor:"#ffcc33",verticalAxisLabelMargin:5.5,gridLines:{dashLength:4,spacingLength:1},seriesRangesByDataEncodingType:{t:{min:0,max:100},s:{min:0,max:61},e:{min:0,max:4095}}};if(typeof CanvasRenderingContext2D.prototype.dashedLine!=="function"){CanvasRenderingContext2D.prototype.dashedLine=function(c,j,b,i,g,f){if(typeof g==="undefined"){g=YOKUL.defaults.gridLines.dashLength;}if(typeof f==="undefined"){f=YOKUL.defaults.gridLines.spacingLength;}this.beginPath();this.moveTo(c,j);if(g===0){this.lineTo(b,i);}else{var e=b-c;var d=i-j;var h=Math.floor(Math.sqrt(e*e+d*d)/g);var l=e/h;var k=d/h;var a=0;while(a++<=h){c+=l;j+=k;this[a%2==0?"moveTo":"lineTo"](c,j);}}this.stroke();this.closePath();};}if(typeof Array.prototype.clone!=="function"){Array.prototype.clone=function Array_clone(){var a=[],c,b=this.length;for(c=0;c<b;++c){a.push(this[c]);}return a;};}if(typeof Array.prototype.contains!=="function"){Array.prototype.contains=function Array_contains(c){var b=0,a=this.length;for(;b<a;++b){if(this[b]===c){return true;}}return false;};}YOKUL.chartTypes={bar:{verticalStacked:"bvs",verticalGrouped:"bvg",verticalOverlapped:"bvo",specific:{automaticFitBarWidth:"automaticFitBarWidth"},defaults:{barWidth:23,betweenBarWidth:4,betweenGroupWidth:8,betweenBarWidthSoleA:3,betweenGroupWidthSoleA:3}}};YOKUL.chartTypesMap={bvs:YOKUL.chartTypes.bar.verticalStacked,bvg:YOKUL.chartTypes.bar.verticalGrouped,bvo:YOKUL.chartTypes.bar.verticalOverlapped};YOKUL.Tokenizer=function Tokenizer(b){if(b===undefined||b===null||b.length===0){throw new Error("Tokenizer: constructed without any input");}var a=/^[^?]+\?(.+)$/.exec(b);if(!a||a.length!==2){throw new Error("Tokenizer: found no valid query input in the raw string: "+b);}this._inputString=a[1];this._tokenize(this._inputString);this._currentIndex=-1;};YOKUL.Tokenizer.prototype._tokenize=function Tokenizer_tokenize(a){this._tokens=[];var e=a.split("&");for(var c=0;c<e.length;++c){var d=e[c];if(!d||d.length===0||d.match(/^[ \t]$/)){continue;}var b=d.split("=");if(b.length!==2){throw new Error("Tokenizer: encountered unexpected input: %%"+d+"%%");}this._tokens.push({key:b[0],value:b[1]});}};YOKUL.Tokenizer.prototype.tokenCount=function Tokenizer_tokenCount(){return this._tokens.length;};YOKUL.Tokenizer.prototype.current=function Tokenizer_current(){return this._tokens[this._currentIndex];};YOKUL.Tokenizer.prototype.moveNext=function Tokenizer_moveNext(){this._currentIndex+=1;return this._currentIndex<this._tokens.length;};YOKUL.BarSpacing=function BarSpacing(b,c,a){this._barWidth=b||YOKUL.chartTypes.bar.defaults.barWidth;if(this._barWidth==="a"&&c===undefined){this._betweenBars=3;}else{this._betweenBars=(c===undefined)?YOKUL.chartTypes.bar.defaults.betweenBarWidth:c;}if(this._barWidth==="a"&&a===undefined){this._betweenGroups=3;}else{this._betweenGroups=(a===undefined)?YOKUL.chartTypes.bar.defaults.betweenGroupWidth:a;}};YOKUL.BarSpacing.prototype.getBarWidth=function BarSpacing_getBarWidth(b,a,c){if(this._barWidth!=="a"){return this._barWidth;}else{if(typeof b==="undefined"||typeof c==="undefined"){throw new Error("BarSpacing.getBarWidth: barWidth is set to automatic, so please provude numBars and availableWidth parameters");}return(c-(this._betweenBars*b)-(this._betweenGroups*a))/b;}};YOKUL.BarSpacing.prototype.getBetweenBars=function BarSpacing_getBetweenBars(){return this._betweenBars;};YOKUL.BarSpacing.prototype.getBetweenGroups=function BarSpacing_getBetweenGroups(){return this._betweenGroups;};YOKUL.BarSpacing.prototype.isAutomaticBarWidth=function BarSpacing_isAutomaticBarWidth(){return this._barWidth==="a";};YOKUL.GridSpacing=function GridSpacing(e,d,c,a,b,f){if(typeof e==="undefined"){throw new Error("GridSpacing: xStepSize is required");}if(typeof d==="undefined"){throw new Error("GridSpacing: yStepSize is required");}this._xStepSize=e;this._yStepSize=d;if(c||a||b||f){throw new Error("GridSpacing: optional features arent implemented yet");}};YOKUL.GridSpacing.prototype.getXStepSize=function GridSpacing_getXStepSize(){return this._xStepSize;};YOKUL.GridSpacing.prototype.getYStepSize=function GridSpacing_getYStepSize(){return this._yStepSize;};YOKUL.Parser=(function(){var d={t:function l(y){function z(E){E=E.replace(/_/g,",null,");var C=[];var D=E.split(",");for(var A=0;A<D.length;++A){var B=D[A];if(B!==undefined&&B!==""){if(B==="null"){C.push(null);}else{C.push(parseFloat(B));}}}return C;}var x=[];var w=y.split("|");for(var v=0;v<w.length;++v){x.push(z(w[v]));}return x;},s:function l(y){function z(B){if(B>="A"&&B<="Z"){return B.charCodeAt(0)-"A".charCodeAt(0);}else{if(B>="a"&&B<="z"){return B.charCodeAt(0)-"a".charCodeAt(0)+26;}else{if(B>="0"&&B<="9"){return B.charCodeAt(0)-"0".charCodeAt(0)+52;}else{return -1;}}}}function A(D){var C=[];for(var B=0;B<D.length;++B){C.push(z(D.charAt(B)));}return C;}var x=[];var w=y.split(",");for(var v=0;v<w.length;++v){x.push(A(w[v]));}return x;}};var s={chs:function k(w){var v=w.split("x");if(v.length!==2){throw new Error("Parser:chs: unexpected input: "+w);}this._size={w:parseInt(v[0],10),h:parseInt(v[1],10)};if(this._size.w>1000){YOKUL.log.warning("Width, "+this._size.w+", is greater than Google's maximum of 1000");}if(this._size.h>1000){YOKUL.log.warning("Height, "+this._size.h+", is greater than Google's maximum of 1000");}},cht:function i(v){this._chartType=YOKUL.chartTypesMap[v];if(this._chartType===undefined){throw new Error("Parser::cht: unknown value: "+v);}},chd:function r(w){var v=w.split(":");if(v.length!==2){throw new Error("Parser::chd: unknown value: "+w);}this._dataEncodingType=v[0];this._chartDataBySeries=d[this._dataEncodingType](v[1]);},chtt:function t(v){v=v.replace(/\+/g," ");this._title=v.split("|");},chts:function u(w){var v=w.split(",");if(v.length!==2){throw new Error("Parser::chts: unexpected value: "+w);}this._titleStyle={color:"#"+v[0],size:parseInt(v[1],10)};},chbh:function b(z){var x,y,v;var w=z.split(",");if(w.length>0){if(w[0]==="a"){x="a";}else{x=parseInt(w[0],10);if(isNaN(x)){x=YOKUL.chartTypes.bar.defaults.barWidth;}}}else{x=YOKUL.chartTypes.bar.defaults.barWidth;}if(w.length>1){y=parseInt(w[1],10);if(isNaN(y)){y=YOKUL.chartTypes.bar.defaults.betweenBarWidth;}}else{if(x==="a"){y=undefined;}else{y=YOKUL.chartTypes.bar.defaults.betweenBarWidth;}}if(w.length>2){v=parseInt(w[2],10);if(isNaN(v)){v=YOKUL.chartTypes.bar.defaults.betweenGroupWidth;}}else{if(x==="a"){v=undefined;}else{v=YOKUL.chartTypes.bar.defaults.betweenGroupWidth;}}this._chartSpacing=new YOKUL.BarSpacing(x,y,v);},chco:function e(y){var x=y.split(",");var v=[];for(var w=0;w<x.length;++w){v.push("#"+x[w]);}this._seriesColors=v;},chds:function n(A){var z=A.split(",");var w=[];for(var y=0;y<z.length;y+=2){var x=parseFloat(z[y]);var v=parseFloat(z[y+1]);w.push({min:x,max:v});}this._seriesRanges=w;},chdl:function q(v){var w=v.split("|");this._legendLabels=w;},chxt:function g(v){this._visibleAxes=v.split(",");},chxr:function h(C){var A=C.split("|");var v=[];for(var z=0;z<A.length;++z){var B=A[z].split(",");var y=parseInt(B[0],10);B=B.splice(1);var x=[];for(var w=0;w<B.length;++w){x.push(parseFloat(B[w]));}v[y]=x;}this._axisRanges=v;},chxl:function m(A){var z=A.split("|");var y={};var w=null;for(var x=0;x<z.length;++x){var A=z[x];if(A.indexOf(":")>-1){var v=parseInt(A,10);y["axis"+v]=[];w=y["axis"+v];}else{if(!w){throw new Error("chxl: invalid value string: "+A);}w.push(A);}}this._axisLabels=y;},chg:function p(w){var v=w.split(",");this._gridSpacing=new YOKUL.GridSpacing(v[0],v[1],v[2],v[3],v[4],v[5]);}};var j=["chem","chfd","chm","chxtc","chxp"];function o(w){for(var v=0;v<j.length;++v){if(j[v]===w){return true;}}return false;}var c=function f(v){var y=new YOKUL.Tokenizer(v);while(y.moveNext()){var w=y.current();YOKUL.log.info("token-> "+w.key);if(o(w.key)){YOKUL.log.warning(w.key+": not currently supported, skipping");continue;}var x=s[w.key];if(x===undefined){YOKUL.log.error("unknown token encountered: "+w.key);}else{try{x.call(this,unescape(w.value));}catch(z){YOKUL.log.error("error during handler of: "+w.key+"::: "+z.toString());}}}};return function a(v){if(v===undefined||v===null||v.length===0){throw new Error("Parser: given no input to parse");}c.call(this,v);};})();YOKUL.Parser.prototype._groupChartData=function _Parser_groupChartData(){var f=Number.MIN_VALUE;var d=this._chartDataBySeries;for(var c=0;c<d.length;c+=1){if(d[c].length>f){f=d[c].length;}}var b=[];for(var c=0;c<f;c+=1){var e=[];for(var a=0;a<d.length;a+=1){e.push(d[a][c]);}b.push(e);}return b;};YOKUL.Parser.prototype.size=function Parser_size(){return this._size;};YOKUL.Parser.prototype.chartType=function Parser_chartType(){return this._chartType;};YOKUL.Parser.prototype.getDataEncodingType=function Parser_getDataEncodingType(){return this._dataEncodingType;};YOKUL.Parser.prototype.chartDataBySeries=function Parser_chartDataBySeries(){return this._chartDataBySeries;};YOKUL.Parser.prototype.chartDataGrouped=function Parser_chartDataGrouped(){if(this._chartDataGrouped===undefined){this._chartDataGrouped=this._groupChartData();}return this._chartDataGrouped;};YOKUL.Parser.prototype.title=function Parser_title(){return this._title;};YOKUL.Parser.prototype.titleStyle=function Parser_titleStyle(){return this._titleStyle;};YOKUL.Parser.prototype.chartSpacing=function Parser_chartSpacing(){if(!this._chartSpacing){this._chartSpacing=new YOKUL.BarSpacing();}return this._chartSpacing;};YOKUL.Parser.prototype.hasGridSpacing=function Parser_hasGridSpacing(){return !!(this._gridSpacing);};YOKUL.Parser.prototype.gridSpacing=function Parser_gridSpacing(){return this._gridSpacing;};YOKUL.Parser.prototype.seriesRanges=function Parser_seriesRanges(){return this._seriesRanges;};YOKUL.Parser.prototype.legendLabels=function Parser_legendLabels(){return this._legendLabels;};YOKUL.Parser.prototype.seriesColors=function Parser_seriesColors(){return this._seriesColors;};YOKUL.Parser.prototype.visibleAxes=function Parser_visibleAxes(){if(!this._visibleAxes){this._visibleAxes=[];}return this._visibleAxes;};YOKUL.Parser.prototype.axisRanges=function Parser_axisRanges(){return this._axisRanges;};YOKUL.Parser.prototype.visibleAxesCount=function Parser_visibleAxesCount(d){var e=this.visibleAxes();var c=0;for(var b=0,a=e.length;b<a;++b){if(e[b]===d){++c;}}return c;};YOKUL.Parser.prototype.axisLabels=function Parser_axisLabels(){return this._axisLabels;};YOKUL.Parser.prototype.legendSpecified=function Parser_legendSpecified(){return !!(this._legendLabels);};YOKUL.charts._VerticalBarMixin=(function _VerticalBarMixin(){function o(){return this._imageData;}function n(w){var u=w.title();if(!u){return 0;}var v=w.titleStyle();var t=(v&&(v.size*1.33))||YOKUL.defaults.titleHeight;return t*u.length;}function r(w,t){var y=this._getChartAreaWidth(t);var v={x:0,y:0,w:y,h:t.size().h};var u=this._getTitleHeight(t);v.y+=u;v.h-=u;var x=1+(t.visibleAxesCount("y")*(YOKUL.defaults.axisLabelHeight/4));x+=t.visibleAxesCount("x")*YOKUL.defaults.axisLabelHeight;v.h-=x;var z=6;z+=t.visibleAxesCount("t")*YOKUL.defaults.axisLabelHeight;v.y+=z;v.h-=z;var B=this;function E(H,L){var M=B._getAxisLabels(H,L,t,v.h);var G=0;if(M&&M[H]){for(var I=0;I<M.length;++I){var F=w.measureText(M[I]).width;if(F>G){G=F;}}}else{var K=t.chartDataBySeries();if(K&&K[H]){var J=YOKUL.utility.max(K[H]);G=w.measureText(J.toString()).width;}}return G+YOKUL.defaults.verticalAxisLabelMargin*2;}var D=1;var C=t.visibleAxes();for(var A=0;A<C.length;++A){if(C[A]=="y"){D+=E(A,"y");}}v.x+=D;if(t.chartSpacing().isAutomaticBarWidth()){v.w-=D+1;}return v;}function p(u,w){var v=w.axisRanges();if(v&&v[u]){var t=v[u];return{min:t[0],max:t[1]};}return YOKUL.defaults.seriesRangesByDataEncodingType[w.getDataEncodingType()];}function b(z,w,u,C){var t=u.axisLabels(),E=null,y;if(t&&t["axis"+z]){E=t["axis"+z];}else{if(w==="y"||w==="r"){E=[];var v=10;var D=this._getAxisRange(z,u);var A=(D.max-D.min)/v;var x=D.min;while(x%A!==0){x+=1;}for(y=0;y<=v;++y){E.push(Math.round(x).toString());x+=A;}}else{var B=u.chartDataBySeries()[0].length;E=[];for(y=0;y<B;++y){E.push(y.toString());}}}return E;}function d(u,v,y){var x=y.visibleAxes().clone(),t;if(!x.contains("x")){x.push("x");}if(!x.contains("y")){x.push("y");}var w={drawXAxis:s,drawYAxis:k,drawTAxis:h,drawRAxis:e};for(t=0;t<x.length;++t){w["draw"+x[t].toUpperCase()+"Axis"](u,v,y);}}function c(w,z,t,A){var D=this;var F=t.visibleAxes();var u=0;w.strokeStyle="Gray";w.fillStyle=YOKUL.defaults.axisLabelColor;w.font=YOKUL.defaults.axisLabelFont;function y(M,L,O){var K=YOKUL.defaults.axisLabelHeight;var G=z.w/L.length;var I=z.x+G/2;var H=z.y+z.h+(K*(M+1));if(A==="t"){H=z.y-((K*(M+1))/2);}for(var J=0;J<L.length;++J){if(O){w.beginPath();w.moveTo(I,H-(K-4));w.lineTo(I,H-(K+1));w.closePath();w.stroke();}var N=w.measureText(L[J]).width;w.fillText(L[J],I-N/2,H);I+=G;}}function C(M,L,O,J,K){if(!J){J=0;}if(!K){K=0;}var R=YOKUL.defaults.verticalAxisLabelMargin/2+K;var Q=z.y-J;var P=z.h;var H=P/(L.length-1);for(var I=L.length-1;I>=0;--I){if(O){w.beginPath();w.moveTo(z.x+0.5,Q+0.5);w.lineTo(z.x-3+0.5,Q+0.5);w.closePath();w.stroke();}var N=w.measureText(L[I]).width;if(A==="r"){N=0;}var S=z.x-YOKUL.defaults.verticalAxisLabelMargin-2;var G=R+S-N;w.fillText(L[I],G,Q+YOKUL.defaults.axisLabelHeight/4);Q+=H;}}function x(){if(A==="r"){return z.w+12;}return 0;}function v(){return 0;}var E=(A==="x"||A==="t")?y:C;for(var B=0;B<F.length;++B){if(F[B]===A){E(u,this._getAxisLabels(B,A,t,(A==="x"||A==="r")?z.w:z.h),A!=="t",v(),x());}}}function f(t,v){var u=v.seriesRanges();if(u&&u[t]){return u[t];}if(u&&u[0]){return u[0];}return YOKUL.defaults.seriesRangesByDataEncodingType[v.getDataEncodingType()];}function g(t,v){var u=v.seriesColors();if(u&&u[t]){return u[t];}if(u&&u[t%u.length]){return u[t%u.length];}return YOKUL.defaults.seriesColor;}function i(y,z,A){y.strokeStyle="#afafaf";var w=A.gridSpacing();var x=Math.ceil(z.w*(w.getXStepSize()/100));var u=Math.ceil(z.h*(w.getYStepSize()/100));var v=z.x+x+0.5;while(v<=z.x+z.w){y.dashedLine(v,z.y+0.5,v,z.y+0.5+z.h);v+=x;}y.dashedLine(z.x+z.w,z.y,z.x+z.w,z.y+z.h);var t=z.y+0.5;while(t<z.y+z.h){y.dashedLine(z.x+0.5,t,z.x+z.w+0.5,t);t+=u;}}function s(t,u,v){t.strokeStyle="gray";t.beginPath();t.moveTo(u.x+0.5,u.y+u.h+0.5);t.lineTo(u.x+u.w+0.5,u.y+u.h+0.5);t.closePath();t.stroke();}function k(t,u,v){t.strokeStyle="gray";t.beginPath();t.moveTo(u.x+0.5,u.y+0.5);t.lineTo(u.x+0.5,u.y+u.h+0.5);t.closePath();t.stroke();}function e(t,u,v){t.strokeStyle="gray";t.beginPath();t.moveTo(u.x+u.w+0.5,u.y+0.5);t.lineTo(u.x+u.w+0.5,u.y+u.h+0.5);t.closePath();t.stroke();}function h(t,u,v){}function q(u,x,t){var C=6;var w=12;var A=t.legendLabels();var v=t.seriesColors();var D=(w+C)*A.length-C;var z=u.canvas.height/2-D/2+w;var B=x.x+x.w+5;for(var y=0;y<A.length;++y){u.save();u.fillStyle=this._getSeriesColor(y,t);u.fillRect(B,z,w,w);u.fillStyle="gray";u.fillText(A[y],B+w+C,z+((w+C)/2));u.restore();z+=w+C;}}function a(u){var t=u.titleStyle();return(t&&t.size+"px sans-serif")||YOKUL.defaults.titleFont;}function m(u){var t=u.titleStyle();return(t&&t.color)||YOKUL.defaults.titleColor;}function j(x,y,w){var C=w.title();if(C){x.font=a(w);x.fillStyle=m(w);var A=0;if(y.x+y.w>x.canvas.width){A=x.canvas.width-y.x;}else{A=y.w;}var v=y.x+A/2;var u=n(w)/C.length;var t=u/3;for(var z=0;z<C.length;++z){var D=C[z];var B=x.measureText(D);x.fillText(D,v-B.width/2,u*(z+1)-t);}}}function l(w,x,t,v){YOKUL.useContext(t,function(y){y.fillStyle="#FFFFFF";y.fillRect(0,0,y.canvas.width,y.canvas.height);});var u=this;if(x.hasGridSpacing()){YOKUL.useContext(t,function(y){u._drawGrid(y,v,x);});}YOKUL.useContext(t,function(y){u._drawChartArea(y,v,x);});YOKUL.useContext(t,function(y){u._drawAxes(y,v,x);});YOKUL.useContext(t,function(y){u._drawAxisLabels(y,v,x,"x");});YOKUL.useContext(t,function(y){u._drawAxisLabels(y,v,x,"y");});YOKUL.useContext(t,function(y){u._drawAxisLabels(y,v,x,"r");});YOKUL.useContext(t,function(y){u._drawAxisLabels(y,v,x,"t");});YOKUL.useContext(t,function(y){u._drawTitle(y,v,x);});if(x.legendSpecified()){YOKUL.useContext(t,function(y){u._drawLegend(y,v,x);});}}return function(){this._measureChartArea=r;this._getTitleHeight=n;this._getAxisRange=p;this._getAxisLabels=b;this._drawAxes=d;this._drawAxisLabels=c;this._getSeriesRange=f;this._getSeriesColor=g;this._drawGrid=i;this._drawLegend=q;this._drawTitle=j;this._createChartImageCore=l;this.imageData=o;};})();YOKUL.charts.VerticalBarGrouped=function VerticalBarGrouped(a){this._imageData=this._createChartImage(a);};YOKUL.charts._VerticalBarMixin.call(YOKUL.charts.VerticalBarGrouped.prototype);YOKUL.charts.VerticalBarGrouped.prototype._getChartAreaWidth=function vbg_getChartAreaWidth(f){var b=f.chartSpacing();if(b.isAutomaticBarWidth()){return f.size().w;}var d=f.chartDataGrouped();var c=b.getBarWidth();var a=d[0].length;var e=(a*c)+((a-1)*b.getBetweenBars())+(b.getBetweenGroups());return d.length*e;};YOKUL.charts.VerticalBarGrouped.prototype._drawChartArea=function vbg_drawChartArea(c,n,d){var t=d.chartSpacing();var a=d.chartDataBySeries();var w=d.chartDataGrouped();var f=n.h;var p=n.x;var l=t.getBarWidth(a.length*a[0].length,a.length,n.w);var b=w[0].length;var j=(b*l)+((b-1)*t.getBetweenBars())+(t.getBetweenGroups());for(var u=0;u<w.length;++u){var q=p+(j*u)+t.getBetweenGroups()/2+t.getBetweenBars()/2;for(var s=0;s<w[u].length;++s){var v=this._getSeriesRange(s,d);var k=v.max-v.min;var h=n.y+f*(v.max/k);var o=w[u][s]||0;var m=f*(o/k);var r=Math.abs(m);var e=h;if(o>0){e=h-r;}c.fillStyle=this._getSeriesColor(s,d);c.fillRect(q,e,l,r);q+=l+t.getBetweenBars();}}};YOKUL.charts.VerticalBarGrouped.prototype._createChartImage=function VerticalBarGrouped_createChartImage(d){var e=new YOKUL.Parser(d);var a=document.createElement("canvas");a.width=e.size().w;a.height=e.size().h;var b=a.getContext("2d");var c=this._measureChartArea(b,e);this._createChartImageCore(d,e,b,c);return a.toDataURL("image/png");};YOKUL.charts.VerticalBarStacked=function VerticalBarStacked(a){this._imageData=this._createChartImage(a);};YOKUL.charts._VerticalBarMixin.call(YOKUL.charts.VerticalBarStacked.prototype);YOKUL.charts.VerticalBarStacked.prototype._getChartAreaWidth=function vbs_getChartAreaWidth(f){var a=f.chartSpacing();if(a.isAutomaticBarWidth()){return f.size().w;}var d=f.chartDataGrouped();var b=a.getBarWidth();var e=d.length;var c=b+a.getBetweenBars();return e*c;};YOKUL.charts.VerticalBarStacked.prototype._drawChartArea=function vbs_drawChartArea(c,n,d){var t=d.chartSpacing();var b=d.chartDataBySeries();var w=d.chartDataGrouped();var f=n.h;var p=n.x;var l=t.getBarWidth(b.length*b[0].length,b.length,n.w);var j=l+t.getBetweenBars();for(var u=0;u<w.length;++u){var q=p+(j*u)+t.getBetweenBars()/2;var a=0;for(var s=0;s<w[u].length;++s){var o=w[u][s]||0;if(o<=0){continue;}var v=this._getSeriesRange(s,d);var k=v.max-v.min;var h=n.y+f*(v.max/k);var m=f*(o/k);var r=Math.abs(m);var e=h;if(o>0){e=h-r;}c.fillStyle=this._getSeriesColor(s,d);c.fillRect(q,e-a,l,r);a+=r;}}};YOKUL.charts.VerticalBarStacked.prototype._createChartImage=function vbs_createChartImage(d){var e=new YOKUL.Parser(d);var a=document.createElement("canvas");a.width=e.size().w;a.height=e.size().h;var b=a.getContext("2d");var c=this._measureChartArea(b,e);this._createChartImageCore(d,e,b,c);return a.toDataURL("image/png");};YOKUL.charts.VerticalBarOverlapped=function VerticalBarOverlapped(a){this._imageData=this._createChartImage(a);};YOKUL.charts._VerticalBarMixin.call(YOKUL.charts.VerticalBarOverlapped.prototype);YOKUL.charts.VerticalBarOverlapped.prototype._getChartAreaWidth=function vbo_getChartAreaWidth(f){var a=f.chartSpacing();if(a.isAutomaticBarWidth()){return f.size().w;}var d=f.chartDataGrouped();var b=a.getBarWidth();var e=d.length;var c=b+a.getBetweenBars();return e*c;};YOKUL.charts.VerticalBarOverlapped.prototype._sortDataByHeight=function vbo_sortDataByHeight(c){var a=[];function e(g,f){return f-g;}for(var b=0;b<c.length;++b){var d=c[b].clone();d.sort(e);a.push(d);}return a;};YOKUL.charts.VerticalBarOverlapped.prototype._drawChartArea=function vbo_drawChartArea(b,n,c){var t=c.chartSpacing();var a=c.chartDataBySeries();var w=c.chartDataGrouped();var m=this._sortDataByHeight(w);var e=n.h;var p=n.x;var k=t.getBarWidth(a.length*a[0].length,a.length,n.w);var h=k+t.getBetweenBars();for(var u=0;u<w.length;++u){var q=p+(h*u)+t.getBetweenBars()/2;for(var s=0;s<w[u].length;++s){var o=m[u][s]||0;if(o<=0){continue;}var v=this._getSeriesRange(s,c);var j=v.max-v.min;var f=n.y+e*(v.max/j);var l=e*(o/j);var r=Math.abs(l);var d=f;if(o>0){d=f-r;}b.fillStyle=this._getSeriesColor(w[u].indexOf(o),c);b.fillRect(q,d,k,r);}}};YOKUL.charts.VerticalBarOverlapped.prototype._createChartImage=function vbo_createChartImage(d){var e=new YOKUL.Parser(d);var a=document.createElement("canvas");a.width=e.size().w;a.height=e.size().h;var b=a.getContext("2d");var c=this._measureChartArea(b,e);this._createChartImageCore(d,e,b,c);return a.toDataURL("image/png");};YOKUL.chartCreator=(function(){_chartConstructors={bvg:YOKUL.charts.VerticalBarGrouped,bvs:YOKUL.charts.VerticalBarStacked,bvo:YOKUL.charts.VerticalBarOverlapped};function b(c){var e=/cht=([^&]+)/;var d=e.exec(c);return d&&d[1];}function a(c){var d=b(c);var e=_chartConstructors[d];if(e){return new e(c);}else{YOKUL.log.error("This chart type not yet supported: "+d);return null;}}return{create:function(f,c){var d=document.getElementById(f);if(!d){YOKUL.log.error("chartCreator.create: no element with id, "+f+", exists");return;}if(d.nodeName.toUpperCase()!=="IMG"){YOKUL.log.error("chartCreator.create: YOKUL can only create charts for img elements, passed in: "+d.nodeName);return;}if(typeof c==="undefined"){c=YOKUL.utility.getQueryDataFromElement(d);if(!c){YOKUL.log.error("chartCreator.create: no query data for this chart was found ("+f+")");return;}}var e=a(c);if(e){d.src=e.imageData();}}};})();YOKUL.convertAllImages=function YOKUL_convertAllImages(){var a=document.getElementsByTagName("img");if(a!==null){for(var b=0;b<a.length;++b){var c=a[b];if(!c.id){c.id="chartImage"+b;}if(c&&(c.getAttribute("data-src")||c.getAttribute("data-chart-src"))){YOKUL.chartCreator.create(c.id);}}}};